<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> router · code and eat and drink and life</title><meta name="description" content="router - YL"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/blog/favicon.png"><link rel="stylesheet" href="/blog/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://lycworks.me/blog/atom.xml" title="code and eat and drink and life"></head><body><div class="wrap"><header><a href="/blog/" class="logo-link"><img src="/blog/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/blog/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/blog/tags/" target="_self" class="nav-list-link">TAG</a></li><li class="nav-list-item"><a href="http://lycworks.me" target="_blank" class="nav-list-link">WEBSITE</a></li><li class="nav-list-item"><a href="https://github.com/ylu021" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/blog/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">router</h1><div class="post-info">Feb 17, 2017</div><div class="post-content"><h1 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h1><p>understand by doing, best <a href="https://www.youtube.com/watch?v=fPgE67iLkns" target="_blank" rel="external">video</a> found.</p>
<p>Word version</p>
<ul>
<li>create pages folder for each route eg <code>Home, About and etc</code></li>
<li>create a NotFound 404 page to deal with unknown url cases</li>
<li>in source folder where App.js is stored, create routes.js</li>
<li><code>npm install react-router</code></li>
<li>import the router and the components</li>
<li>create a constant called Routes and create a Router JSX<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">const Routes = (props) =&gt; (</div><div class="line">    &lt;Router &#123;...props&#125;&gt;</div><div class="line">    ..nest for single page</div><div class="line">    &lt;/Router&gt;</div><div class="line">)</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="Single-page"><a href="#Single-page" class="headerlink" title="Single page"></a>Single page</h1><p>To create single page render, nest inside Router props, so that the embedded/nested are all accessible through <code>this.props.children</code> (will be explained later).<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">const Routes = (props) =&gt; (</div><div class="line">    &lt;Router &#123;...props&#125;&gt;</div><div class="line">      &lt;Route path=&apos;/&apos; component=&#123; App &#125;&gt;</div><div class="line">        &lt;Route path=&apos;/about&apos; component=&#123; About &#125; /&gt;</div><div class="line">        &lt;Route path=&apos;*&apos; component=&#123; NotFound &#125; /&gt;</div><div class="line">      &lt;/Route&gt;</div><div class="line">    &lt;/Router&gt;</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>From this structure, what are accessible? Let’s review.<br>First of all we have <code>this.props</code> where <code>this</code> refers to <code>routes.js</code>, and its children is <code>App</code>.<br>Also, <code>App</code> itself contains children <code>About</code> and <code>NotFound</code>. So we can do the following to add the components onto our App.</p>
<h1 id="Add-the-components-in-App-js"><a href="#Add-the-components-in-App-js" class="headerlink" title="Add the components in App.js"></a>Add the components in App.js</h1><p>So in App.js, <code>this</code> refers to the <code>App</code>, we can do <code>this.props.children</code> to obtain the <code>About</code> and <code>NotFound</code> components. The adding component part is really easy, add this one-liner at the place you want it to display - <code>{this.props.children}</code>.</p>
<h1 id="Add-the-router-in-index-js"><a href="#Add-the-router-in-index-js" class="headerlink" title="Add the router in index.js"></a>Add the router in index.js</h1><p>What is index.js? As seen in the pacakge.json setting files, index is the entry point, where everything got rendered. In here, if we create react app using the command <code>create-react-app</code>, we will see something like this.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">  &lt;App /&gt;,</div><div class="line">  document.getElementById(&apos;root&apos;)</div><div class="line">);</div></pre></td></tr></table></figure>
<p>This means a App component is being rendered at the DOM <code>#root</code>.</p>
<p>To add our router, we need to do just these three steps</p>
<ul>
<li>import our <code>Routes</code> from <code>routes.js</code></li>
<li>import <code>browserHistory</code> from <code>react-router</code></li>
<li>replace the render <code>App</code> to our <code>Routes</code></li>
</ul>
<blockquote>
<p>What is browserHistory? browserHistory is used for url readability, to prevent cases like <code>website.com/#/page</code> to occur, which can seem odd to users. For more info, check their github doc <a href="https://github.com/ReactTraining/react-router/blob/master/docs/guides/NavigatingOutsideOfComponents.md" target="_blank" rel="external">browserHistory</a>.</p>
</blockquote>
<h1 id="Passing-params"><a href="#Passing-params" class="headerlink" title="Passing params"></a>Passing params</h1><p><a href="http://stackoverflow.com/questions/32901538/how-does-react-router-pass-params-to-other-components-via-props" target="_blank" rel="external">Referencing source</a></p>
<p>Luckily, this step is internally programmed in <code>react-router</code>. for example in a const routes’s props, if i do<br><code>&lt;Route path=&quot;/posts/:id&quot; component={ Post } /&gt;</code>, I can automatically get the id by <code>this.props.params.id</code> in the <code>Post</code> component, which is magical. Why does this works? Dive deeper into the structure of <code>react-router</code>.</p>
<h3 id="Understand-React-router-structure"><a href="#Understand-React-router-structure" class="headerlink" title="Understand React-router structure"></a>Understand React-router structure</h3><p><code>react-router</code> uses props to pass all the routing info to the children components recursively.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;Router history=&#123;new HashHistory&#125;&gt;</div><div class="line">  &lt;Route path=&quot;/&quot; component=&#123;Main&#125;&gt;</div><div class="line">    &lt;Route path = &quot;topics/:id&quot; component=&#123;Topic&#125;&gt;&lt;/Route&gt;</div><div class="line">  &lt;/Route&gt;</div><div class="line">&lt;/Router&gt;</div></pre></td></tr></table></figure>
<p>for this example, react-router will go through each, starting from Main to Topic, and pass the following fundamental props to each of the components when the component is created (where it is rendered!) using React.createElement (its inner function).</p>
<p>What props are passed down?<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">const props = &#123;</div><div class="line">   history,</div><div class="line">   location,</div><div class="line">   params,</div><div class="line">   route,</div><div class="line">   routeParams,</div><div class="line">   routes</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>In other words, these props are internally parsed by <code>react-router</code> using <code>this.createElement(components[key], props)</code>, therefore one can access the <code>:id</code> in component <code>Topic</code> by simply doing <code>{this.props.params.id}</code></p>
<h1 id="Afterword"><a href="#Afterword" class="headerlink" title="Afterword"></a>Afterword</h1><p>I hope this tutorial is clear and useful, if you have any question or suggestion, feel free to leave a comment below. </p>
</div><div><label>Tags:</label><a href="/blog/tags/react/">#react</a>| <a href="/blog/tags/router/">#router</a></div></article></div></main><footer><div class="paginator"><a href="/blog/2017/02/21/redux/" class="prev">上一篇</a><a href="/blog/2017/02/14/ux-thinking/" class="next">下一篇</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'https-ylu021-github-io-blog';
var disqus_identifier = '2017/02/17/router/';
var disqus_title = 'router';
var disqus_url = 'http://lycworks.me/blog/2017/02/17/router/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//https-ylu021-github-io-blog.disqus.com/count.js" async></script><div class="copyright"><p>© 2017 <a href="http://lycworks.me/blog">YL</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-71046273-3",'auto');ga('send','pageview');</script></body></html>